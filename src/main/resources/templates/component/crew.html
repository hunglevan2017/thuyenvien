<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorator="layout/layout">
   <head>
      <title>Header</title>
   </head>
   <body>
      <!--  table-responsive -->
      <div class="content" layout:fragment="content" id="root">
         <div class="row" v-if="profile.seaThongTinThuyenVien" >
            <div class="col-md-8">
               <div class="card">
                  <div class="card-header">
                     <h5 class="title" style="color:#f96332">
                     Profile  
                     <a style="color:black" :href="'/crew/resume/' + profile.seaThongTinThuyenVien.id " v-if=" profile.seaThongTinThuyenVien.id != null "> | Resumes  </a>
                     <a style="color:black" :href="'/crew/certificate/' + + profile.seaThongTinThuyenVien.id" v-if=" profile.seaThongTinThuyenVien.id != null "> | Certificate  </a>
                     <a style="color:black" :href="'/crew/rank/' + + profile.seaThongTinThuyenVien.id" v-if=" profile.seaThongTinThuyenVien.id != null "> | Rank  </a>
                     </h5>
                  </div>
                  <div v-show="debug">
                     <p>{{profile.seaThongTinThuyenVien}}</p>
                  </div>
                  <ul v-if="errors && errors.length" id="error_id">
                     <li v-for="error of errors" style="color:red">
                        {{error.message}}
                     </li>
                  </ul>
                  <div class="card-body">
                     <form>
                        <div class="row"  v-if="profile.seaThongTinThuyenVien">
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label class="requiredStar">Name</label>
                                 <input type="text" class="form-control"  v-model="profile.seaThongTinThuyenVien.hoten" >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group" >
                                 <label>Material Status</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.tinhtranghonnhan" >
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1" >
                              <div class="form-group">
                                 <label>D.O.B</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.ngaysinh"  >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Place of birth</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.noisinh">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Height</label>
                                 <input type="text" class="form-control"  v-model="profile.seaThongTinThuyenVien.chieucao">
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Weight</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.cannang">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Bank Account No</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.sotaikhoannganhang" >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Repatriation Destination</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.diemhoihuong">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Mobile</label>
                                 <input type="text" class="form-control"  v-model="profile.seaThongTinThuyenVien.dtdidong" >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Home Phone</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.dtnha">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-12">
                              <div class="form-group">
                                 <label>Email</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.email">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-12">
                              <div class="form-group">
                                 <label>Permanent Address</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.diachihokhau">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-12">
                              <div class="form-group">
                                 <label>Temporary Address</label>
                                 <input type="text" class="form-control"  v-model="profile.seaThongTinThuyenVien.diachitamchu">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-4 pr-1">
                              <div class="form-group">
                                 <label>Gender</label>
                                 <select v-model="profile.seaThongTinThuyenVien.gioitinh" class="form-control" tabindex="-1">
                                    <option value="true">Male</option>
                                    <option value="false">Female</option>
                                 </select>
                              </div>
                           </div>
                           <div class="col-md-4 px-1">
                              <div class="form-group">
                                 <label>Nationality</label>
                                 <select class="form-control" v-model="profile.seaThongTinThuyenVien.quoctich" >
                                    <option v-for="option in nations" v-bind:value="option.lov.id" >{{ option.text }}</option>
                                 </select>
                              </div>
                           </div>
                           <div class="col-md-4 pl-1">
                              <div class="form-group">
                                 <label>Blood Type</label>
                                 <select v-model="profile.seaThongTinThuyenVien.nhommau" class="form-control" tabindex="-1">
                                    <option value="None">None</option>
                                    <option value="A">A</option>
                                    <option value="AP">A+</option>
                                    <option value="B">B</option>
                                    <option value="BP">B+</option>
                                    <option value="AB">AB</option>
                                    <option value="O">O</option>
                                    <option value="OP">O+</option>
                                 </select>
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-4 pr-1">
                              <div class="form-group">
                                 <label class="requiredStar">ID Card</label>
                                 <input type="text" class="form-control"  v-model="profile.seaThongTinThuyenVien.cmnd" >
                              </div>
                           </div>
                           <div class="col-md-4 px-1">
                              <div class="form-group">
                                 <label>Issued Date</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.cmndngaycap">
                              </div>
                           </div>
                           <div class="col-md-4 pl-1">
                              <div class="form-group">
                                 <label>Issued Place</label>
                                 <input  class="form-control" v-model="profile.seaThongTinThuyenVien.cmndnoicap">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-4 pr-1">
                              <div class="form-group">
                                 <label>Size of clothes</label>
                                 <select class="form-control" v-model="profile.seaThongTinThuyenVien.sizequanao" >
                                    <option v-for="option in clothes" v-bind:value="option.lov.id" >{{ option.text }}</option>
                                 </select>
                              </div>
                           </div>
                           <div class="col-md-4 pl-1">
                              <div class="form-group">
                                 <label>Size of shoes</label>
                                 <select class="form-control" v-model="profile.seaThongTinThuyenVien.sizegiay" >
                                    <option v-for="option in shoes" v-bind:value="option.lov.id" >{{ option.text }}</option>
                                 </select>
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-12">
                              <div class="form-group">
                                 <label>Note</label>
                                 <textarea rows="4" cols="80" class="form-control"  ></textarea>
                              </div>
                           </div>
                        </div>
                        <label for="upload-file-input">Image:</label>
                        <input onclick="this.select();" type="file" ref="file" v-on:change="handleFileUpload()" accept="*">
                     </form>
                  </div>
               </div>
            </div>
            <div class="col-md-4">
               <div class="card card-user">
                  <div class="image">
                     <img th:src="@{/images/bg5.jpg}" alt="...">
                  </div>
                  <div class="card-body">
                     <div class="author">
                        <a href="#">
                        	<div v-if="profile.seaFile && profile.seaFile.name" >
                          	 <img  v-if="profile.seaFile" class="avatar border-gray" v-bind:src="profile.seaFile.name" alt="..." style="margin-bottom: 0.5em;">
                           </div>
                           <div v-else>
                           <img class="avatar border-gray" th:src="@{/images/picture.jpg}" alt="..." style="margin-bottom: 0.5em;">
                           </div>
                           <h5 class="title rightProfile" style="margin-bottom: 0.5em;" v-if="profile.seaThongTinThuyenVien" >{{profile.seaThongTinThuyenVien.hoten}}</h5>
                        </a>
                        <div v-if="profile.seaThongTinThuyenVien">
                           <div class="form-group input-group" v-if="profile.seaThongTinThuyenVien.ngaysinh">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa fa-birthday-cake"></i> </span>
                              </div>
                              <input  class="form-control"  type="text"  v-model="profile.seaThongTinThuyenVien.ngaysinh" readonly style="background-color:white" >
                           </div>
                           <div class="form-group input-group"  v-if="profile.shortProfileCrew.status_ship!=null ">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa  fa-exclamation-circle"></i> </span>
                              </div>
                              <input  class="form-control rightProfile"  type="text" value="On board" v-bind:value="profile.shortProfileCrew.status_ship"  readonly style="background-color:white"  >
                           </div>
                           <div class="form-group input-group" v-if=" profile.shortProfileCrew.tauOffHoacOnGanNhat!=null">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa  fa-ship"></i> </span>
                              </div>
                              <input  class="form-control rightProfile"  type="text"  v-bind:value="profile.shortProfileCrew.tauOffHoacOnGanNhat" readonly style="background-color:white" >
                           </div>
                           <div class="form-group input-group" v-if=" profile.shortProfileCrew.ngayOffHoacOnGanNhat">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa fa-calendar-alt"></i> </span>
                              </div>
                              <input  class="form-control rightProfile"  type="text"  v-bind:value="profile.shortProfileCrew.ngayOffHoacOnGanNhat" readonly style="background-color:white" >
                           </div>
                           <div class="form-group input-group" v-if="profile.seaThongTinThuyenVien.chucdanhtheochuyenmonid != null">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa  fa-exclamation-circle"></i> </span>
                              </div>
                              <input  class="form-control rightProfile"  type="text"  v-bind:value="'COMP.CERT : ' + profile.seaThongTinThuyenVien.chucdanhtheochuyenmonid  " readonly style="background-color:white">
                           </div>
                           <div class="form-group input-group" v-if="profile.shortProfileCrew.chucdanh != null ">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa  fa-exclamation-circle"></i> </span>
                              </div>
                              <input  class="form-control rightProfile"  type="text"  v-bind:value="'ONBROARD : ' + profile.shortProfileCrew.chucdanh" readonly style="background-color:white">
                           </div>
                           <div class="form-group input-group" v-if=" profile.seaThongTinThuyenVien.email">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa fa-envelope"></i> </span>
                              </div>
                              <input  class="form-control rightProfile" placeholder="Email address" type="email"  v-bind:value="profile.seaThongTinThuyenVien.email" readonly style="background-color:white">
                           </div>
                           <div class="form-group input-group" v-if="profile.seaThongTinThuyenVien.dtdidong != null">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa fa-phone"></i> </span>
                              </div>
                              <input  class="form-control"  type="text"  v-bind:value=" 'Mobile : ' + profile.seaThongTinThuyenVien.dtdidong " readonly style="background-color:white">
                           </div>
                           <div class="form-group input-group" v-if=" profile.seaThongTinThuyenVien.dtnha != null ">
                              <div class="input-group-prepend">
                                 <span class="input-group-text"> <i class="fa fa-phone"></i> </span>
                              </div>
                              <input  class="form-control"  type="text"  v-bind:value="'Home : ' + profile.seaThongTinThuyenVien.dtnha" readonly style="background-color:white">
                           </div>
                           <div class="form-group input-group" v-if="profile.seaThongTinThuyenVien.diachitamchu != null">
                           
                              <textarea rows="20" cols="100" class="form-control"  v-bind:value="'Address : ' +profile.seaThongTinThuyenVien.diachitamchu" ></textarea>
                           </div>
                           <div class="form-group input-group">
                              <a id="btnSave" class="btn " style="background: #f96332;color: white;" v-on:click="Save"><i class="fa fa-edit m-right-xs" ></i>Save Profile</a>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
         </div>
         <div class="row" v-if="profile.seaThongTinThuyenVien" >
            <div class="col-md-8">
               <div class="card">
                  <div class="card-header">
                     <h5 class="title">Working Status</h5>
                  </div>
                  <div class="card-body">
                     <form>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Date With Operator</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.ngaybatdaulamviec"  >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Status</label>
                                 <select v-model="profile.seaThongTinThuyenVien.tinhtrangdieudong"  class="form-control"  disabled>
                                    <option value="0">On leave</option>
                                    <option value="1">On board</option>
                                 </select>
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Rank As Comp. Cert</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.chucdanhtheochuyenmonid" >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Condition</label>
                                 <select  name="trangthaiid" v-model="profile.seaThongTinThuyenVien.trangthaiid" class="form-control"  >
                                    <option value="1" > Crew</option>
                                    <option value="0" > Applicant</option>
                                    <option value="-2"> Resign</option>
                                 </select>
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Date of profile received</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.datecheckby" >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Applicant - Checked by</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.checkby" >
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Resign - Reason</label>
                                 <select class="form-control" v-model="profile.seaThongTinThuyenVien.reason" >
                                    <option v-for="option in reasons" v-bind:value="option.lov.id" >{{ option.text }}</option>
                                 </select>
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Resign - Date applied</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.dateapplied">
                              </div>
                           </div>
                        </div>
                        <div class="row" v-if="profile.seaThongTinThuyenVien" >
                           <div class="col-md-6 pr-1">
                              <div class="form-group">
                                 <label>Date Request Received</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.request"  >
                              </div>
                           </div>
                           <div class="col-md-6 pl-1">
                              <div class="form-group">
                                 <label>Date Agreement Completed</label>
                                 <input type="text" class="form-control" v-model="profile.seaThongTinThuyenVien.agreement"> 
                              </div>
                           </div>
                        </div>
                     </form>
                  </div>
               </div>
            </div>
         </div>
         <script>
            new Vue({
                el: '#root',
                data: {
                  profile: {},
                  errors: [],
                  nations:[],
                  clothes:[],
                  shoes:[],
                  reasons:[],
                  debug: false
            
                },
                mounted() {
                  this.LoadData();
                },
                computed: {},
                methods: {
            
                  // Get Group
                  LoadData() {
                	var pageURL = window.location.href;
                	
                    axios.get( $('#PageContext').val() + "crew/profile/" + pageURL.substr(pageURL.lastIndexOf('/') + 1)  )
                      .then(response => {
                        this.profile = response.data;
                        
                    //    this.profile.seaThongTinThuyenVien.ngaysinh = this.frontEndDateFormat(this.profile.seaThongTinThuyenVien.ngaysinh);
                   //     this.profile.shortProfileCrew.ngayOffHoacOnGanNhat = this.frontEndDateFormat(this.profile.shortProfileCrew.ngayOffHoacOnGanNhat);
                   //     this.profile.seaThongTinThuyenVien.ngaybatdaulamviec = this.frontEndDateFormat(this.profile.shortProfileCrew.ngaybatdaulamviec);
                        
                        
                        if(this.profile.seaFile && this.profile.seaFile.name)
                        {
                        	this.profile.seaFile.name = $('#PageContext').val() +'disk/' + this.profile.seaFile.name;
                        }
                      })
                      .catch(e => {
                        this.errors.push(e)
                      });
                    
                    axios.get( $('#PageContext').val() + "masterdata/S001"  )
                    .then(response => {
                      this.nations = response.data;
                    })
                    .catch(e => {
                      this.errors.push(e)
                    });
                    
                    axios.get( $('#PageContext').val() + "masterdata/S002"  )
                    .then(response => {
                      this.clothes = response.data;
                    })
                    .catch(e => {
                      this.errors.push(e)
                    });
                    
                    axios.get( $('#PageContext').val() + "masterdata/S003"  )
                    .then(response => {
                      this.shoes = response.data;
                    })
                    .catch(e => {
                      this.errors.push(e)
                    });
                    
                    axios.get( $('#PageContext').val() + "masterdata/S011"  )
                    .then(response => {
                      this.reasons = response.data;
                    })
                    .catch(e => {
                      this.errors.push(e)
                    });
                  },
                  frontEndDateFormat: function(date) {
                      return moment(date).format('DD/MM/YYYY');
                  },
                  backEndDateFormat: function(date) {
                      return moment(date, 'DD/MM/YYYY').format('YYYY-MM-DD');
                  },
                  handleFileUpload(){
                	    this.file = this.$refs.file.files[0];
                	    let formData = new FormData();
                	    formData.append('file', this.file);
                	    axios.post( $('#PageContext').val() + "crew/upload",formData,  {headers: {'Content-Type': 'multipart/form-data'}})
                        .then(response => {
                        	
                          this.profile.seaFile = response.data;
                          if(this.profile.seaFile.name)
                          {
                          	this.profile.seaFile.name = $('#PageContext').val() +'disk/' + this.profile.seaFile.name;
                          }
                          
                        })
                        .catch(e => {
                          this.errors.push(e)
                        });
                  },
            
                  
            
                  Save: function(event) {
            
                    //Validate Form
                    this.errors = [];
                    console.log (this.profile.seaThongTinThuyenVien.hoten);
                    if (this.profile.seaThongTinThuyenVien.hoten == null)
                    {
                      this.errors.push({
                        message: "Name required."
                      });
                    }
                    
                    if (this.profile.seaThongTinThuyenVien.cmnd == null)
                    {
                      this.errors.push({
                        message: "ID Card required."
                      });
                    }
                    if (!this.errors.length) {
                      // Call Insert
                      axios.post( $('#PageContext').val() + "crew/save", this.profile)
                        .then(response => {
                        	window.location.replace( $('#PageContext').val() + "crew/" + response.data.seaThongTinThuyenVien.id  );
                   
                        })
                        .catch(e => {
                          this.errors.push(e)
                        })
                    }
                  }
            
                }
            
              });
         </script>
      </div>
   </body>
</html>